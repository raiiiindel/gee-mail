<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>

      window.onload = function(){
      	var contentContainer = document.getElementById('main');
      	//Deleting "Build Me"
      	contentContainer.innerHTML = "";

      	//creating header div
      	var headerDiv = document.createElement('div');
      	headerDiv.id = 'headerDiv';

      	//creating h1 elem in header div
      	var headerElem = document.createElement('h1');
      	headerElem.id = "pageHeader";
      	headerElem.innerHTML = "GeeMail!";
      	headerDiv.appendChild(headerElem);

      	//creating counter
      	var counterDiv = document.createElement('div');
      	counterDiv.id = "counterDiv";
      	var sum = 0;
      	function emailCounter(arr){
      		sum += arr.length;
      	}
      	emailCounter(geemails);

      	counterDiv.innerHTML = " Inbox: " + sum;
      	headerDiv.appendChild(counterDiv);



      	//appending header div to content container(body)
      	contentContainer.appendChild(headerDiv);

/*
      	function addNewMessage(){
      			var newMess = getNewMessage();
      			geemails.push(newMess);
      		}
      		addNewMessage();
      		console.log(geemails);

      	setInterval(addNewMessage, 3000);*/



      	//populating data stored in window.geemails
      	function messageRows(arr){
      		for (var i=0; i<arr.length; i++){

      			
      			//creating message row
      			var messageRow = document.createElement('div');
      			messageRow.className = 'messageRow';
      			//creating sender
      			var senderDiv = document.createElement('div');
      			senderDiv.className = 'senderDiv';
      			senderDiv.innerHTML = arr[i].sender;
      			messageRow.appendChild(senderDiv);
      			//creating date
      			var dateDiv = document.createElement('div');
      			dateDiv.className = 'dateDiv';
      			dateDiv.innerHTML = arr[i].date;
      			messageRow.appendChild(dateDiv);
      			//creating subject
      			var subjectDiv = document.createElement('div');
      			subjectDiv.className = "subjectDiv";
      			subjectDiv.innerHTML = arr[i].subject;
      			messageRow.appendChild(subjectDiv);
      			//creating body
      			var bodyDiv = document.createElement('div');
      			bodyDiv.className = 'bodyDiv';
      			bodyDiv.innerHTML = arr[i].body;
      			bodyDiv.style.display = 'none';
      			subjectDiv.appendChild(bodyDiv);





      			contentContainer.appendChild(messageRow);
      		}

      	

      		


      		function createNewMessage(){

      			var newMess = getNewMessage();
      			console.log(newMess);
      			setInterval(getNewMessage, 3000);
      			//creating new message row
      			var newMessage = document.createElement('div');
      			newMessage.className = "messageRow";
      			//creating sender
      			var senderDiv = document.createElement('div');
      			senderDiv.className = 'senderDiv';
      			senderDiv.innerHTML = newMess.sender;
      			newMessage.appendChild(senderDiv);
      			console.log(newMess.sender);
      			console.log(senderDiv);
      			//creating date
      			var dateDiv = document.createElement('div');
      			dateDiv.className = 'dateDiv';
      			dateDiv.innerHTML = newMess.date;
      			newMessage.appendChild(dateDiv);
      			//creating subject
      			var subjectDiv = document.createElement('div');
      			subjectDiv.className = "subjectDiv";
      			subjectDiv.innerHTML = newMess.subject;
      			newMessage.appendChild(subjectDiv);
      			//creating body
      			var bodyDiv = document.createElement('div');
      			bodyDiv.className = 'bodyDiv';
      			bodyDiv.innerHTML = newMess.body;
      			bodyDiv.style.display = 'none';
      			subjectDiv.appendChild(bodyDiv);

   
      		contentContainer.appendChild(newMessage);
      		}

      		createNewMessage();
      		


      	}
      	messageRows(geemails);

      	//adding toggle function to subject 
      	var subToggle = document.getElementsByClassName('subjectDiv'); 
      	console.log("subtoggle ", subToggle);   	
      	for(var i=0; i<subToggle.length; i++){
      		subToggle[i].addEventListener('click', showBodyInfo);
      		}
      	function showBodyInfo(){
      		console.log("this ", this);
      		var bodyNode = this.lastChild;
      		console.log("body node", bodyNode);
      		console.log(this.className);
      		if(bodyNode.style.display === 'none'){
      			bodyNode.style.display = 'block';
      		}else{
      			bodyNode.style.display = 'none';
      			console.log("else");
      		}
      	}

      	//create new message
      	


      	

      	      	
      	

      	

      console.log(geemails);
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser



        
    };

    </script>
	</head>
	<body>
		<div class="container" id="main">
			Build Me!
		</div>
	</body>
</html>